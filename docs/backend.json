{
  "entities": {
    "Product": {
      "title": "Product",
      "type": "object",
      "description": "Represents a food item available in the restaurant's menu.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the product." },
        "name": { "type": "string", "description": "Name of the product." },
        "description": { "type": "string", "description": "Detailed description of the product." },
        "imageUrl": { "type": "string", "description": "URL of the product image.", "format": "uri" },
        "price": { "type": "number", "description": "Price of the product." },
        "stockQuantity": { "type": "number", "description": "The remaining quantity of the product." },
        "category": { "type": "string", "description": "Category of the product (e.g., burger, pizza, drink)." }
      },
      "required": ["id", "name", "description", "imageUrl", "price", "stockQuantity", "category"]
    },
    "User": {
      "title": "User",
      "type": "object",
      "description": "Represents a user of the application.",
      "properties": {
        "uid": { "type": "string", "description": "Unique identifier for the user, from Firebase Auth." },
        "displayName": { "type": "string", "description": "Display name of the user." },
        "email": { "type": "string", "description": "Email address of the user.", "format": "email" },
        "photoURL": { "type": "string", "description": "URL of the user's profile picture.", "format": "uri" },
        "role": { "type": "string", "description": "Role of the user (e.g., customer, admin, host, driver, developer).", "enum": ["customer", "admin", "host", "driver", "developer"]},
        "phoneNumber": { "type": "string", "description": "Phone number of the user." },
        "deliveryAddress": { "type": "string", "description": "Primary delivery address of the user." },
        "createdAt": { "type": "string", "description": "Timestamp of user creation.", "format": "date-time" }
      },
      "required": ["uid", "role"]
    },
    "Order": {
      "title": "Order",
      "type": "object",
      "description": "Represents a customer order.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the order." },
        "customerId": { "type": "string", "description": "The UID of the user who placed the order." },
        "orderDate": { "type": "string", "description": "Date and time the order was placed.", "format": "date-time" },
        "totalAmount": { "type": "number", "description": "Total amount of the order." },
        "deliveryFee": { "type": "number", "description": "Fee for the delivery service." },
        "tip": { "type": "number", "description": "Tip for the delivery driver." },
        "paymentMethod": { "type": "string", "description": "Payment method (e.g., cash, transfer)." },
        "deliveryAddress": { "type": "string", "description": "Delivery address for the order." },
        "status": { "type": "string", "description": "Status of the order (e.g., pending, cooking, ready, delivering, delivered, cancelled)." },
        "driverId": { "type": "string", "description": "The UID of the assigned delivery driver." },
        "driverName": { "type": "string", "description": "The name of the assigned delivery driver." },
        "pin": { "type": "string", "description": "A 4-digit PIN for delivery confirmation." },
        "items": { 
            "type": "array", 
            "items": { 
                "type": "object",
                "properties": {
                    "productId": {"type": "string"},
                    "product": {
                        "type": "object",
                        "properties": {
                            "name": {"type": "string"},
                            "price": {"type": "number"},
                            "imageUrl": {"type": "string"}
                        }
                    },
                    "quantity": {"type": "number"}
                }
            } 
        }
      },
      "required": ["id", "customerId", "orderDate", "totalAmount", "deliveryAddress", "status", "pin", "items"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "google.com"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/products/{productId}",
        "definition": {
          "entityName": "Product",
          "schema": { "$ref": "#/entities/Product" },
          "description": "Stores all product information for the menu."
        }
      },
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": { "$ref": "#/entities/User" },
          "description": "Stores public and private user data."
        }
      },
      {
        "path": "/users/{userId}/orders/{orderId}",
        "definition": {
          "entityName": "Order",
          "schema": { "$ref": "#/entities/Order" },
          "description": "Stores order data as a subcollection of the user who owns it."
        }
      },
      {
        "path": "/roles_admin/{userId}",
        "definition": {
          "schema": { "type": "object", "properties": {"uid": {"type": "string"}, "grantedAt": {"type": "string", "format": "date-time"}} },
          "description": "Manages admin roles. The existence of a document grants admin privileges to the user with the corresponding UID."
        }
      }
    ]
  }
}
